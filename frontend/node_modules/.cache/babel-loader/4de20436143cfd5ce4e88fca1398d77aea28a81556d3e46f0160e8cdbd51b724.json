{"ast":null,"code":"import _slicedToArray from\"/home/wassimzo/Bureau/WEB/ZeroToHero/TODO/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState,useEffect,createContext}from\"react\";import{useNavigate}from\"react-router-dom\";import axios from\"axios\";import Cookies from\"js-cookie\";import{jsx as _jsx}from\"react/jsx-runtime\";axios.defaults.xsrfCookieName=\"csrftoken\";axios.defaults.xsrfHeaderName=\"X-CSRFToken\";axios.defaults.withCredentials=true;var client=axios.create({baseURL:\"http://127.0.0.1:8000/api\",headers:{\"Accept\":\"application/json\",\"content-Type\":\"application/json\",\"X-CSRFToken\":Cookies.get(\"csrftoken\")}});export var UserContext=/*#__PURE__*/createContext();export function UserContextProvider(props){var _useState=useState(),_useState2=_slicedToArray(_useState,2),currentUser=_useState2[0],setCurrentUser=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var navigate=useNavigate();useEffect(function(){client.get(\"/user\").then(function(res){console.log(res);setCurrentUser(true);}).catch(function(err){setCurrentUser(false);});},[]);var signUp=function signUp(username,pwd){client.post(\"/register\",{username:username,password:pwd}).then(function(res){client.post(\"/login\",{username:username,password:pwd}).then(function(res){setCurrentUser(true);setUsername(username);navigate(\"/private/home\");});});};var signIn=function signIn(username,pwd){client.post(\"/login\",{username:username,password:pwd}).then(function(res){setCurrentUser(true);setUsername(username);navigate(\"/private/home\");});};var logout=function logout(){client.post(\"/logout\").then(function(res){setCurrentUser(false);navigate(\"/private/home\");});};return/*#__PURE__*/_jsx(UserContext.Provider,{value:{signUp:signUp,currentUser:currentUser,signIn:signIn,logout:logout,username:username},children:props.children});}","map":{"version":3,"names":["useContext","useState","useEffect","createContext","useNavigate","axios","Cookies","jsx","_jsx","defaults","xsrfCookieName","xsrfHeaderName","withCredentials","client","create","baseURL","headers","get","UserContext","UserContextProvider","props","_useState","_useState2","_slicedToArray","currentUser","setCurrentUser","_useState3","_useState4","username","setUsername","navigate","then","res","console","log","catch","err","signUp","pwd","post","password","signIn","logout","Provider","value","children"],"sources":["/home/wassimzo/Bureau/WEB/ZeroToHero/TODO/frontend/src/Context/UserContext.js"],"sourcesContent":["import { useContext, useState, useEffect, createContext } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport Cookies from \"js-cookie\";\n\naxios.defaults.xsrfCookieName = \"csrftoken\";\naxios.defaults.xsrfHeaderName = \"X-CSRFToken\";\naxios.defaults.withCredentials = true;\n\nconst client = axios.create({\n\tbaseURL: \"http://127.0.0.1:8000/api\",\n\theaders: {\n\t\t\"Accept\": \"application/json\",\n\t\t\"content-Type\": \"application/json\",\n\t\t\"X-CSRFToken\": Cookies.get(\"csrftoken\"),\n\t},\n});\n\nexport const UserContext = createContext();\n\nexport function UserContextProvider(props) {\n\tconst [currentUser, setCurrentUser] = useState();\n\tconst [username, setUsername] = useState();\n\tconst navigate = useNavigate();\n\n\tuseEffect(() => {\n\t\tclient\n\t\t\t.get(\"/user\")\n\t\t\t.then((res) => {\n\t\t\t\tconsole.log(res);\n\t\t\t\tsetCurrentUser(true);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tsetCurrentUser(false);\n\t\t\t});\n\t}, []);\n\n\tconst signUp = (username, pwd) => {\n\t\tclient\n\t\t\t.post(\"/register\", {\n\t\t\t\tusername: username,\n\t\t\t\tpassword: pwd,\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tclient\n\t\t\t\t\t.post(\"/login\", {\n\t\t\t\t\t\tusername: username,\n\t\t\t\t\t\tpassword: pwd,\n\t\t\t\t\t})\n\t\t\t\t\t.then((res) => {\n\t\t\t\t\t\tsetCurrentUser(true);\n\t\t\t\t\t\tsetUsername(username);\n\t\t\t\t\t\tnavigate(\"/private/home\");\n\t\t\t\t\t});\n\t\t\t});\n\t};\n\n\tconst signIn = (username, pwd) => {\n\t\tclient\n\t\t\t.post(\"/login\", {\n\t\t\t\tusername: username,\n\t\t\t\tpassword: pwd,\n\t\t\t})\n\t\t\t.then((res) => {\n\t\t\t\tsetCurrentUser(true);\n\t\t\t\tsetUsername(username);\n\t\t\t\tnavigate(\"/private/home\");\n\t\t\t});\n\t};\n\n\tconst logout = () => {\n\t\tclient.post(\"/logout\").then((res) => {\n\t\t\tsetCurrentUser(false);\n\t\t\tnavigate(\"/private/home\");\n\t\t});\n\t};\n\n\treturn (\n\t\t<UserContext.Provider\n\t\t\tvalue={{ signUp, currentUser, signIn, logout, username }}\n\t\t>\n\t\t\t{props.children}\n\t\t</UserContext.Provider>\n\t);\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}